---
title: 'Converting Next Pages to App Directory'
excerpt: 'Updating a project that uses the next pages setup to the newer app
setup. To slowly learn what is changing and better understand the process.'
coverImage: '/assets/blog/img_bin/next_js_incremental_guide.png'
date: '2023-10-06T13:06:07.192Z'
author:
  name: 'Justin Bender'
  picture: '/assets/blog/authors/bender.png'
ogImage:
  url: '/assets/blog/img_bin/next_js_incremental_guide.png'
---

# Converting Next Pages to App Directory

The project that is going to be converted is a completed and working
application. There is a high chance that it will have errors all over the place.
This is just part of the struggle. Move a few pieces and see what errors come
up. Move a few more until it seems to work. Possibly running tests along the
way. It shouldn't be too much of a struggle until we get to the more complex
pages. At first it will be simple(ish).

We will use the [From Pages to App](https://nextjs.org/docs/pages/building-your-application/upgrading/app-router-migration#migrating-from-pages-to-app)
Vercel's NextJS guide. This will help us with the basics and find problems that
we may not understand ourselves.

* The app is already at version 13. So we will not be updating the version in a
  major way. We will just be bumping up to the latest version.
* There is an updated:
  - Image component
  - Link component
  - Script component
  - Font optimization
* Date fetching functions like `getServerSideProps` and `getStaticProps` have
  been replaced with a new API inside `app`. `getStaticPaths` has been replaced
  with `generateStaticParams`.

In the beginning we should note that the application needs a starting point.
There will be two different places if you're in the app directory or the pages
directory. The app directory has a layout and a page. The pages directory has a
`_app` and a `_document`. For the root layout.

* `pages/404.js` has been replaced with `not-found.js`.
* `pages/api/*` currently remain inside the pages directory. What? Isn't there
  also an API route in the app directory? Yes, we have the ability to have both
  the API route in the pages and the app directory. It just changes the setup.

Let's take a look at the new setup for the `layout.tsx`:

```typescript
export default function RootLayout({
  // Layouts must accept a children prop.
  // This will be populated with nested layouts or pages
  children,
}: {
  children: React.ReactNode
}) {
  return (
    <html lang="en">
      <body>{children}</body>
    </html>
  )
}
```

* Why do we use normal html tags instead of imported `next/document` components?
  This is a question that we will hope to answer later.
* App directory must include the `layout`. You must define the `<html>` and
  `<body>` tags since NextJS does not automatically create them.
* Root layout does replace `_app` and `_document`.

You can manage the meta data in different layouts and pages with the `Metadata`
import.

```typescript
import { Metadata } from 'next'
 
export const metadata: Metadata = {
  title: 'Home',
  description: 'Welcome to Next.js',
}
```

### Migrating `_document` and `_app`

If you have the existing `_app` or `_document` file, you can copy the contents
(e.g. global styles) to the root layout. The styles in the `app/layout` will not
apply to the `pages/*`. You should keep the `_app/_document` while migrating to
prevent routes breaking. Once fully migrated you can safely delete them.

* With styled components we will need to use `client` components. It's not
  available in server components as of the writing of this post.
